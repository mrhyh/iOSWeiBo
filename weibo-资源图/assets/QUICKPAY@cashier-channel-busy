{"data":{"children":[{"children":[{"content":"text/html; charset=UTF-8","http-equiv":"Content-Type","tag":"meta"},{"content":"width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, minimal-ui","name":"viewport","tag":"meta"},{"src":"cashier-channel-busy.js","tag":"script"},{"children":[{"tag":"text","text":"var is_flybird = navigator.userAgent.toLowerCase().indexOf(\"flybird\")>=0;//### 是否为飞鸟引擎\nvar is_android = navigator.userAgent.toLowerCase().indexOf(\"android\")>=0;//### 是否为android平台\nvar path = is_android ? \"com.alipay.android.app/\" : \"AlipaySDK.bundle/\";\n\nvar arrow_left_png = path + \"arrow_left.png\";\nvar close_png = path + \"close.png\";\nvar arrow_right_png = path + \"arrow_right.png\";\n\nvar hui_png = path + \"hui.png\";\nvar fan_png = path + \"fan.png\";\nvar busy_png = path + \"busy.png\";\nvar gou_png = path + \"gou.png\";\n\nvar channel_icon_margin_left = 5;\n\n\n//### 创建支付渠道\nfunction createPaymentItem(item, index) {\n    var channal = document.getElementById('channel');\n    \n    var common_immersion_item = document.createElement(\"div\");\n    common_immersion_item.className = \"common_immersion_item\";\n    \n    var loading_img = undefined;\n    \n\tif (item[\"disable\"]) {\n        //### 渠道不通\n    }\n    else {\n        //### 切换渠道事件\n        common_immersion_item.onclick = function() {\n            \n            if (item[\"checked\"]) {\n                ant.submit({\"action\":{\"name\":\"loc:back\"}});\n                return;\n            }\n            \n            var submit_obj = {\"action\":{\"name\":\"/cashier/switchChannelSel\", \"loadtxt\":\"\"}};\n            submit_obj[\"param\"] = {\"selected_channel\":item[\"value\"]};\n            submit_obj[\"param\"][\"first_enter_cashier\"] = false;\n            \n            if (item[\"add\"]) {\n\n            }\n            else {\n                submit_obj[\"action\"][\"l2rmode\"] = \"1\";\n            }\n        \n            ant.asyncSubmit(submit_obj, function(data) {\n                    \n                    loading_img.style.display = \"none\";\n                    if (item[\"add\"]) {\n                        document.getElementById('add').style.display = \"inline-block\";\n                    }\n            });\n            \n            if (item[\"add\"]) {\n                document.getElementById('add').style.display = \"none\";\n            }\n            \n            loading_img.style.display = \"inline-block\";\n        }\n    }\n    \n    var common_immersion_left_box = document.createElement(\"div\");\n    common_immersion_left_box.style.cssText = \"display:-webkit-box; -webkit-box-flex:1.0; -webkit-box-pack:center; -webkit-box-orient:vertical\";\n    common_immersion_item.appendChild(common_immersion_left_box);\n    \n    var common_immersion_item_center_box = document.createElement(\"div\");\n    common_immersion_item_center_box.className = \"common_immersion_item_center_box\";\n    common_immersion_item_center_box.style.webkitBoxFlex = 0.0;\n    common_immersion_left_box.appendChild(common_immersion_item_center_box);\n    \n    var item_center_text_div = document.createElement(\"div\");\n    common_immersion_item_center_box.appendChild(item_center_text_div);\n    \n    var common_immersion_item_center_text = document.createElement(\"label\");\n    common_immersion_item_center_text.className = \"common_immersion_item_center_text cashier_pre_confirm_3\";\n    common_immersion_item_center_text.innerText = item[\"name\"];\n    item_center_text_div.appendChild(common_immersion_item_center_text);\n    \n    if (item[\"hui\"]) {\n        var common_immersion_item_center_img = document.createElement(\"img\");\n        common_immersion_item_center_img.src = hui_png;\n        common_immersion_item_center_img.style.marginLeft = channel_icon_margin_left;\n        common_immersion_item_center_box.appendChild(common_immersion_item_center_img);\n    }\n    if (item[\"fan\"]) {\n        var common_immersion_item_center_img = document.createElement(\"img\");\n        common_immersion_item_center_img.src = fan_png;\n        common_immersion_item_center_img.style.marginLeft = channel_icon_margin_left;\n        common_immersion_item_center_box.appendChild(common_immersion_item_center_img);\n    }\n    if (item[\"busy\"]) {\n        var common_immersion_item_center_img = document.createElement(\"img\");\n        common_immersion_item_center_img.src = busy_png;\n        common_immersion_item_center_img.style.marginLeft = channel_icon_margin_left;\n        common_immersion_item_center_box.appendChild(common_immersion_item_center_img);\n    }\n    \n    var common_immersion_item_center_detail_text = undefined;\n    if (item[\"detail\"]) {\n        common_immersion_item_center_detail_text = document.createElement(\"label\");\n        common_immersion_item_center_detail_text.className = \"cashier_pre_confirm_1\";\n        common_immersion_item_center_detail_text.style.cssText = \"color:#999999; display:inline-block; margin-top:6px;\"; \n        common_immersion_item_center_detail_text.innerText = item[\"detail\"];\n        common_immersion_left_box.appendChild(common_immersion_item_center_detail_text);\n    }\n    \n    if (item[\"disable\"]) {\n        if (common_immersion_item_center_detail_text) {\n            common_immersion_item_center_detail_text.style.color = \"#cccccc\";\n        }\n        common_immersion_item_center_text.style.color = \"#cccccc\";\n    }\n    \n    //### 最右边的图片\n    var common_immersion_item_right_img = document.createElement(\"img\");\n    if (item[\"checked\"]) {\n        //### 默认渠道图片\n        common_immersion_item_right_img.src = gou_png;\n        current_channal = index;\n    }\n    else if (item[\"add\"]) {\n        //### 添加新卡图片\n        common_immersion_item_right_img.src = arrow_right_png;\n        common_immersion_item_right_img.id = \"add\";\n    }\n    \n    loading_img = document.createElement(\"img\");\n\tloading_img.src = \"indicatior\";\n\tloading_img.style.display = \"none\";\n\t\n    common_immersion_item.appendChild(loading_img);\n    \n    common_immersion_item.appendChild(common_immersion_item_right_img);\n    \n    channal.appendChild(common_immersion_item);\n    \n    var line = document.createElement(\"div\");\n    line.className = \"common_1px_line\";\n    channal.appendChild(line);\n    \n    return common_immersion_item;\n}\n\nfunction init() {\n\t//### 初始化左上角的图片\n\tif (flybird.rpcData.exit) {\n\t\tdocument.getElementById('arrow_left_png').src = close_png;\n\t}\n\telse {\n\t\tdocument.getElementById('arrow_left_png').src = arrow_left_png;\n\t}\n\t\n\t//### 支付设置入口是否显示由服务端控制\n\tif (flybird.rpcData.setting == false) {\n\t\tdocument.getElementById('right_label').style.display = \"none\";\n\t}\n\t\n\tif(!is_android){\n\t    //### 创建渠道选择页\n\t    for (var i = 0; i < flybird.rpcData.payments.length; i++) {\n\t        var item = createPaymentItem(flybird.rpcData.payments[i], i);\n\t    }\n\t} else {\n\t\tvar channel = document.getElementById('channel');\n\t\tchannel.bizType = \"paychannel\";\n\t\tchannel.list = flybird.rpcData.payments;\n\t\n\t}\n\t\n}\n\n//### 跳转到支付设置\nfunction goto_setting() {\n\tif (document.getElementById('right_label').style.display == \"none\") {\n\t\treturn;\n\t}\n\t\n    ant.submit({\"action\":{\"name\":\"/forward/setting\"}});\n}\n\n//### 后退按钮\n//TODO 逻辑待验证\nfunction onback(){\n\tif (flybird.rpcData.exit) {\n        var dialogObj = {\n            message: '确定要退出吗',\n            okButton: '确定',\n            cancelButton: '取消'\n        };\n        ant.confirm(dialogObj, function (result) {\n            if (result.ok) {\n                ant.submit({\"action\":{\"name\":\"loc:exit\"}});\n            }\n        });\n\t} else {\n    \tant.submit({\"action\":{\"name\":\"loc:back\"}});\n    }\n}"}],"tag":"script","type":"text/javascript"},{"href":"AlipaySDK.bundle/common.css","rel":"stylesheet","tag":"link","type":"text/css"},{"children":[{"tag":"text","text":".div_frame {width:100%; height:100%; transition:0.375s;}"}],"tag":"style"}],"tag":"head"},{"children":[{"children":[{"children":[{"id":"arrow_left_png","tag":"img"}],"css":"common_immersion_title_left_box","onclick":"onback()","style":"z-index:10;","tag":"div"},{"children":[{"children":[{"tag":"text","text":"选择付款方式"}],"css":"common_immersion_title_center_text common_p_reset","id":"title_right","tag":"p"}],"css":"common_immersion_title_center_box","id":"title_box","tag":"div"},{"children":[{"children":[{"tag":"text","text":"设置"}],"css":"common_immersion_title_right_text common_p_reset","id":"right_label","tag":"p"}],"css":"common_immersion_title_right_box","onclick":"goto_setting()","tag":"div"}],"css":"common_immersion_title_box","id":"common_immersion_title","tag":"div"},{"css":"common_1px_title_line","tag":"div"},{"children":[{"children":[{"css":"templatelist common_padding_left_right","id":"channel","tag":"div"}],"css":"div_frame common_immersion_main","id":"channal_area","tag":"div"}],"style":"-webkit-box-flex:1.0;","tag":"div"}],"css":"common_immersion_body","id":"body","onkeydown":"onback();","onload":"init()","tag":"body"}],"tag":"html"},"format":"JSON","name":"cashier-channel-busy","publishVersion":"150604","tag":"QUICKPAY","time":"0063","tplId":"QUICKPAY@cashier-channel-busy","tplVersion":"5.0.0"}