{"data":{"children":[{"children":[{"content":"text/html; charset=UTF-8","http-equiv":"Content-Type","tag":"meta"},{"content":"width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, minimal-ui","name":"viewport","tag":"meta"},{"src":"cashier-new-wk-card.js","tag":"script"},{"children":[{"tag":"text","text":"var is_flybird = navigator.userAgent.toLowerCase().indexOf(\"flybird\")>=0;//### 是否为飞鸟引擎\nvar is_android = navigator.userAgent.toLowerCase().indexOf(\"android\")>=0;//### 是否为android平台\nvar path = is_android ? \"com.alipay.android.app/\" : \"AlipaySDK.bundle/\";\n\nvar cvv_dlg_png = path + \"cvv.png\";\nvar validate_dlg_png_android = path + \"mini_expiry_date_card.png\";\nvar validate_dlg_png_ios = path + \"com_data.png\";\nvar nav_back_png = path + \"back.png\";\nvar info_png = path + \"info.png\";\n\nfunction updateInputState(input, icon) {\n    if (input.value.length) {\n    \ticon.style.display = \"none\";\n    }\n    else {\n    \ticon.style.display = \"inline-block\";  \n    }\n}\n\nfunction checkInput(input, icon) {\n    updateInputState(input, icon);\n    updateSubmitState();\n}\n\nfunction updateSubmitState() {\n    var input_array = document.getElementsByTagName(\"input\");\n\tvar disabled = false;\n    for (var i = 0; i < input_array.length; i++) {\n        if (input_array[i].value == \"\") {\n        \tdisabled = true;\n        \tbreak;\n        }\n    }\n    \n    if (document.getElementById('receiveaddress').innerText == \"\") {\n    \tdisabled = true;\n    }\n   \n    document.getElementById('submit').disabled = disabled;\n}\n\nfunction onCvv2Input() {\n\tvar cvv2 = document.getElementById('cvv2');\n\tif (cvv2.value.length >= 3) {\n\t\tcvv2.blur();\n\t}\n\t\n\tcheckInput(cvv2, document.getElementById('cvv2_info_png'));\n}\n\nfunction onValidateInput() {\n\tvar validate = document.getElementById('validate');\n\tcheckInput(validate, document.getElementById('validate_info_png'));\t\t\n}\n\nfunction onclick_cvv() {\n\tdocument.getElementById('dlg_img').src = cvv_dlg_png;\n\tdocument.getElementById('dlg_text').innerText = \"安全码是打印在信用卡背面签名区域的一组数字，一般是后3位或者4位数字。\";\n\tdocument.getElementById('dlg_title').innerText = \"安全码说明\";\n\tdocument.getElementById('dlg').showModal();\n}\n\nfunction onclick_validate() {\n\tif(is_android){\n\t\tdocument.getElementById('dlg_img').src = validate_dlg_png_android;\n\t} else {\n\t\tdocument.getElementById('dlg_img').src = validate_dlg_png_ios;\n\t}\n\tdocument.getElementById('dlg_text').innerText = \"有效期是打印在信用卡正面卡号下方，标准格式位月份在前，年份在后的一串数字。\";\n\tdocument.getElementById('dlg_title').innerText = \"有效期说明\";\n\tdocument.getElementById('dlg').showModal();\t\n}\n\nfunction onclick_bill() {\n\tvar obj = {\"action\":{\"name\":\"/card/wkSetBillAddress\"}};\n\tobj[\"action\"][\"params\"] = {};\n\tobj[\"action\"][\"params\"][\"call_init\"] = true;\n\tvar submit_obj = {};\n\t\n\tvar input_array = document.querySelectorAll(\"input\");\n\tfor (var i = 0; i < input_array.length; i++) {\n\t\tif (input_array[i].value) {\n\t\t\tsubmit_obj[input_array[i].id] = input_array[i].value;\n\t\t}\n\t}\n\t\n\tobj[\"param\"] = submit_obj;\n\tant.submit(obj);\n}\n\nfunction submit() {\n\n\tvar email = document.getElementById('email');\n\tvar regx = \"^([a-zA-Z0-9_\\.\\-])+\\@(([a-zA-Z0-9\\-])+\\.)+([a-zA-Z0-9]{2,4})+$\";\n\tvar str = email.value;\n\tvar rs = str.match(regx);\n\t\n\tif (rs == undefined) {\n\t\tant.toast({\n  \t\t\t\ttext: '电子邮箱格式不正确',\n       \t\t\ttype: 'fail'\n\t\t\t\t}, function() {\n       \t\t\t\n       \t\t\t\temail.focus();\n       \t\t\t\t\n\t\t\t\t});\n\t\t\t\t\n\t\treturn;\n\t}\n \n\tvar obj = {\"action\":{\"name\":\"/card/sign\"}};\n\tobj[\"action\"][\"neec\"] = \"6004\";\n\tobj[\"action\"][\"host\"] = flybird.rpcData.pci_url;\n\t\n\tobj[\"action\"][\"https\"] = true;\n\tobj[\"action\"][\"enctype\"] = \"application/x-www-form-urlencoded\";\n\tobj[\"action\"][\"request_param\"] = \"requestData\",\n\t             \n\tobj[\"action\"][\"params\"] = {};\n\tobj[\"action\"][\"params\"][\"cardtype\"] = \"WAI_KA\";\n\tobj[\"action\"][\"params\"][\"ccdctoken\"] = flybird.rpcData.ccdctoken;\n\tvar submit_obj = {};\n\t\n\tvar input_array = document.querySelectorAll(\"input\");\n\tfor (var i = 0; i < input_array.length; i++) {\n\t\tif (input_array[i].value) {\n\t\t\tsubmit_obj[input_array[i].id] = input_array[i].value;\n\t\t}\n\t}\n\t\n\tobj[\"param\"] = submit_obj;\n\tant.submit(obj);\n}\n\nfunction onBack() {\n\tant.confirm({\n     \t\ttitle: '',\n            message: '确定要放弃付款？',\n     \t\tokButton: '确定',\n     \t\tcancelButton: '取消'\n\t\t\t}, function (result) {\n     \t\t\n     \t\tif (result.ok) {\n     \t\t\tant.submit({\"action\":{\"name\":\"loc:exit\"}});\n     \t\t}\n\t\t});\n\n}\n\nfunction init() {\n\nif(is_android){\n\t\tdocument.getElementById(\"ios_nav\").style.display = \"none\";\n\t\tdocument.getElementById('nav_back_img_android').src = nav_back_png;\n\t} else{\n        if (!is_android) {\n            \n        }\n        else {\n            document.getElementById(\"android_nav\").style.display = \"none\";\n        }\n\n\t\t//### 加载图片资源\n\t\tdocument.getElementById('nav_back_img').src = nav_back_png;\n\t}\n\n\tvar cvv2_info_png = document.getElementById('cvv2_info_png');\n\tvar validate_info_png = document.getElementById('validate_info_png');\n\tvar cvv2 = document.getElementById('cvv2');\n\tvar validate = document.getElementById('validate');\n\t\n    validate_info_png.src = info_png;\n    cvv2_info_png.src = info_png;\n\n\tdocument.getElementById('cardname').value = flybird.rpcData.needinput.cardname.value;\n\n\tdocument.getElementById('familyname').value = flybird.rpcData.needinput.familyname.value;\n\tdocument.getElementById('forename').value = flybird.rpcData.needinput.forename.value;\n\t\n\tvalidate.value = flybird.rpcData.needinput.validate.value;\n\tcvv2.value = flybird.rpcData.needinput.cvv2.value;\n\t\n\tdocument.getElementById('receiveaddress').value = flybird.rpcData.needinput.receiveaddress.value;\n\tdocument.getElementById('email').value = flybird.rpcData.needinput.email.value;\n\t\n\tcheckInput(cvv2, cvv2_info_png);\n\tcheckInput(validate, validate_info_png);\n}"}],"tag":"script","type":"text/javascript"},{"href":"AlipaySDK.bundle/common.css","rel":"stylesheet","tag":"link","type":"text/css"},{"href":"com.alipay.android.app/common.css","rel":"stylesheet","tag":"link","type":"text/css"},{"tag":"style"}],"tag":"head"},{"children":[{"children":[{"children":[{"children":[{"css":"common_nav_left_img","id":"nav_back_img","tag":"img"},{"children":[{"tag":"text","text":"返回"}],"css":"common_nav_left_text","tag":"p"}],"css":"common_nav_left_box","onclick":"onBack()","tag":"div"},{"children":[{"children":[{"tag":"text","text":"填写银行卡信息"}],"css":"common_nav_center_text","tag":"label"}],"css":"common_nav_center_box","tag":"div"},{"css":"common_nav_right_box","tag":"div"}],"css":"common_nav_box","id":"ios_nav","tag":"div"},{"children":[{"children":[{"children":[{"css":"common_nav_left_img_android","id":"nav_back_img_android","tag":"img"}],"css":"common_nav_back_box_android","onclick":"onBack()","tag":"div"},{"css":"common_nav_line_android","tag":"div"},{"children":[{"tag":"text","text":"填写银行卡信息"}],"css":"common_nav_center_text common_p_reset","tag":"label"}],"css":"common_nav_title_android","id":"nav_back","tag":"div"},{"css":"common_nav_right_box","tag":"div"}],"css":"common_nav_box_android","id":"android_nav","tag":"div"}],"tag":"nav"},{"children":[{"css":"common_1px_line","tag":"div"},{"children":[{"children":[{"children":[{"tag":"text","text":"卡类型"}],"css":"common_cell_left_box_text","tag":"label"}],"css":"common_cell_left_box","tag":"div"},{"children":[{"css":"common_cell_left_box_text","id":"cardname","tag":"label"}],"css":"common_cell_center_box","tag":"div"}],"css":"common_cell common_padding_left_right","tag":"div"},{"css":"common_1px_line","tag":"div"},{"css":"common_cell_footer_empty_box","tag":"div"},{"css":"common_1px_line","tag":"div"},{"children":[{"children":[{"children":[{"tag":"text","text":"姓"}],"css":"common_cell_left_box_text","tag":"label"}],"css":"common_cell_left_box","style":"width: 40px","tag":"div"},{"children":[{"css":"common_cell_input","id":"familyname","oninput":"updateSubmitState()","placeholder":"姓","tag":"input"}],"style":"width: 35%","tag":"div"},{"css":"common_cell_vert_line","style":"margin: 0 10px;","tag":"div"},{"children":[{"children":[{"tag":"text","text":"名"}],"css":"common_cell_left_box_text","tag":"label"}],"css":"common_cell_left_box","style":"width: 40px","tag":"div"},{"children":[{"css":"common_cell_input","id":"forename","oninput":"updateSubmitState()","placeholder":"名","tag":"input"}],"style":"width: 35%","tag":"div"}],"css":"common_cell common_padding_left_right","tag":"div"},{"css":"common_1px_line","tag":"div"},{"children":[{"children":[{"children":[{"tag":"text","text":"有效期"}],"css":"common_cell_left_box_text","tag":"label"}],"css":"common_cell_left_box","tag":"div"},{"children":[{"css":"common_cell_input","id":"validate","oninput":"onValidateInput()","placeholder":"月份/年份","tag":"input","type":"month"}],"css":"common_cell_center_box","tag":"div"},{"children":[{"id":"validate_info_png","onclick":"onclick_validate()","tag":"img"}],"tag":"div"}],"css":"common_cell common_padding_left_right","tag":"div"},{"css":"common_1px_line","tag":"div"},{"children":[{"children":[{"children":[{"tag":"text","text":"安全码"}],"css":"common_cell_left_box_text","tag":"label"}],"css":"common_cell_left_box","tag":"div"},{"children":[{"css":"common_cell_input","id":"cvv2","oninput":"onCvv2Input()","placeholder":"卡背面末三位数字","tag":"input","type":"num"}],"css":"common_cell_center_box","tag":"div"},{"children":[{"id":"cvv2_info_png","onclick":"onclick_cvv()","tag":"img"}],"tag":"div"}],"css":"common_cell common_padding_left_right","tag":"div"},{"css":"common_1px_line","id":"existingItem","tag":"div"},{"css":"common_cell_footer_empty_box","tag":"div"},{"css":"common_1px_line","id":"existingItem","tag":"div"},{"children":[{"children":[{"children":[{"tag":"text","text":"邮箱"}],"css":"common_cell_left_box_text","tag":"label"}],"css":"common_cell_left_box","tag":"div"},{"children":[{"css":"common_cell_input","id":"email","oninput":"updateSubmitState()","placeholder":"请输入邮箱","tag":"input"}],"css":"common_cell_center_box common_height_100","tag":"div"}],"css":"common_cell common_padding_left_right","tag":"div"},{"css":"common_1px_line","tag":"div"},{"css":"common_cell_footer_empty_box","tag":"div"},{"css":"common_1px_line","id":"existingItem","tag":"div"},{"children":[{"children":[{"children":[{"tag":"text","text":"账单地址"}],"css":"common_cell_left_box_text","tag":"label"}],"css":"common_cell_left_box","tag":"div"},{"children":[{"id":"receiveaddress","tag":"label"}],"css":"common_cell_center_box","tag":"div"}],"css":"common_cell common_padding_left_right","onclick":"onclick_bill()","style":"height:auto; padding-top:10px; padding-bottom:10px;","tag":"div"},{"css":"common_1px_line","tag":"div"},{"css":"common_cell_footer_empty_box","tag":"div"},{"children":[{"children":[{"tag":"text","text":"下一步"}],"css":"common_button_main","disabled":"true","id":"submit","onclick":"submit()","tag":"button"}],"css":"common_padding_left_right common_padding_bottom","tag":"div"}],"css":"common_full_main","id":"main_body","tag":"div"},{"children":[{"id":"dlg_title","style":"text-align:center; font-size:17px; color:#000000; font-weight:bold; padding:10px;","tag":"p"},{"children":[{"id":"dlg_img","tag":"img"}],"style":"text-align:center;","tag":"div"},{"id":"dlg_text","style":"text-align:center; font-size:14px; color:#000000; padding:15px;","tag":"p"},{"css":"common_1px_line","tag":"div"},{"children":[{"tag":"text","text":"知道了"}],"css":"common_theme_text_color","id":"btn_main","onclick":"document.getElementById('dlg').close()","style":"width:100%; height:50px; font-size:20px;","tag":"button"}],"id":"dlg","style":"width:300px; border:0px; background-color:#FFFFFF; border-radius:8px; padding:0px;","tag":"dialog"}],"css":"common_full_body","id":"body","onkeydown":"onBack();","onload":"init()","tag":"body"}],"tag":"html"},"format":"JSON","name":"cashier-new-wk-card","publishVersion":"150604","tag":"QUICKPAY","time":"0034","tplId":"QUICKPAY@cashier-new-wk-card","tplVersion":"5.0.0"}