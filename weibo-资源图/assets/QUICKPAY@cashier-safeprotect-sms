{"data":{"children":[{"children":[{"content":"text/html; charset=UTF-8","http-equiv":"Content-Type","tag":"meta"},{"content":"width=device-width, height=200px, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, minimal-ui","name":"viewport","tag":"meta"},{"src":"cashier-safeprotect-sms.js","tag":"script"},{"children":[{"tag":"text","text":"//### 这个页面与cashier-sms视觉类似，但是参数差异较大，且为安全服务化页面。因此单独列出，省得兼容时的麻烦。\n\nvar is_flybird = navigator.userAgent.toLowerCase().indexOf(\"flybird\")>=0;//### 是否为飞鸟引擎\nvar is_android = navigator.userAgent.toLowerCase().indexOf(\"android\")>=0;//### 是否为android平台\nvar path = is_android ? \"com.alipay.android.app/\" : \"AlipaySDK.bundle/\";\nvar nav_back_png = path + \"back.png\";\nvar countDownNum = 60;\n\nvar smsread = {\"template\":\"校验码(\\\\d{4,6})\",\"tempGroup\":\"1\",\"rules\":[\"+8613588124256\",\"95188\",\"106575258188\",\"106980095188\",\"106575170001\",\"106575552766\",\"106575552788\",\"10655057868\",\"10655059666\",\"106590571868\",\"106590202028\",\"106575000086\",\"1069099999\",\"95559\",\"95580\",\"95528\",\"95508\",\"95561\"],\"readTime\":\"180\"};\n\n//### 密码框输入响应\nfunction onPwdInput() {\n\tvar input = document.getElementById('pwd');\n    input.style.cssText=\"color:#000000\";\n\tvar submit = document.getElementById('submit');\t\n\tif (input.value.length > 0) {\n\t\tsubmit.disabled = false;\n\t} else {\n\t\tsubmit.disabled = true;\t\t\n\t}\n}\n\nfunction init() {\nif(is_android){\n\t\tdocument.getElementById(\"ios_nav\").style.display = \"none\";\n\t\tdocument.getElementById('nav_back_img_android').src = nav_back_png;\n\t} else{\n        if (is_flybird) {\n            \n        }\n        else {\n            document.getElementById(\"android_nav\").style.display = \"none\";\n        }\n\n\t\t//### 加载图片资源\n\t\tdocument.getElementById('nav_back_img').src = nav_back_png;\n\t}\n    \n\tdocument.getElementById('main_title').innerText = \"请输入手机号\" + flybird.rpcData.mobileMask + \"收到的短信校验码\";\n    \n    //### 短信倒计时\n    document.getElementById('resend_btn').disabled = true;\n    countDownNum = 60;\n    countDown();\n    \n    //### Android自动读取短信\n    if (is_android){\n        readSms();\n    }\n\tdocument.getElementById('pwd').focus();\n}\n\n//### Android系统自动读取短信帮用户读入\nfunction readSms(){\n    var obj = {\"action\":{\"name\":\"loc:readsms\"}};\n    var submit_obj = {\"smsread\":smsread};\n    obj[\"action\"][\"params\"] = submit_obj;\n    ant.asyncSubmit(obj,function(data){\n        document.getElementById('pwd').innerText = data[\"sms\"];\n    });\n}\n\nfunction submitReSend(){\n    //### 倒计时过程中，不触发提交操作\n    if (countDownNum > 0){\n        return;\n    }\n    \n\tvar obj = {};\n    \n    obj[\"action\"] = {\n        \"name\": flybird.rpcData.sendsms_params.uri,\n        \"host\": flybird.rpcData.host,\n        \"https\": true,\n        \"namespace\": \"com.alipay.securitycore\",\n        \"apiName\" : \"com.alipay.seccorepay\",\n        \"apiVersion\": \"1.0.0\",\n        \"params\" : {}\n    };\n    \n    //### 保险起见\n    if (!flybird.rpcData.host){\n        obj[\"action\"][\"https\"] = false;\n    }\n    \n    //### 没有用户提交的参数\n    obj[\"param\"] = {};\n    \n    //### 透传参数\n\tif (flybird.rpcData.sendsms_params){\n        obj[\"action\"][\"params\"] = flybird.rpcData.sendsms_params;\n\t}\n\tif (flybird.rpcData.sms_template){\n\t    obj[\"action\"][\"params\"][\"sms_template\"]  = flybird.rpcData.sms_template;\n\t}\n\tif (flybird.rpcData.local){\n\t    obj[\"action\"][\"params\"][\"local\"]  = flybird.rpcData.local;\n\t}\n\tif (flybird.rpcData.resend_url){\n\t    obj[\"action\"][\"params\"][\"resend_url\"]  = flybird.rpcData.resend_url;\n\t}\n    \n\tant.asyncSubmit(obj, function(data) {\n        //### TODO 返回数据，貌似不用处理。\n\t});\n    document.getElementById('resend_btn').disabled = true;\n    countDownNum = 60;\n    countDown();\n\tdocument.getElementById('pwd').value = \"\";\n\tdocument.getElementById('submit').disabled = true;\n}\n\n//### 倒计时\nfunction countDown(){\n    if (countDownNum > 0){\n        document.getElementById('resend_btn').innerText = String(countDownNum) + \"秒后重发\";\n        countDownNum = countDownNum - 1;\n        setTimeout(countDown,1000);\n    }else{\n        document.getElementById('resend_btn').innerText = \"重发验证码\";\n        document.getElementById('resend_btn').disabled = false;\n    }\n}\n\n//### 确认按钮,提交业务数据\nfunction submitInfo() {\n    //### 提交前隐藏输入框\n    document.getElementById(\"pwd\").blur();\n    \n\tvar obj = {};\n    \n    obj[\"action\"] = {\n        \"name\": flybird.rpcData.submit_params.uri,\n        \"host\": flybird.rpcData.host,\n        \"https\": true,\n        \"namespace\": \"com.alipay.securitycore\",\n        \"apiName\" : \"com.alipay.seccorepay\",\n        \"apiVersion\": \"1.0.0\"\n    };\n    \n    //### 保险起见\n    if (!flybird.rpcData.host){\n        obj[\"action\"][\"https\"] = false;\n    }\n    \n\t//透传数据\n\tif (flybird.rpcData.submit_params){\n        obj[\"action\"][\"params\"] = flybird.rpcData.submit_params;\n\t}\n\tif (flybird.rpcData.sms_template){\n\t    obj[\"action\"][\"params\"][\"sms_template\"]  = flybird.rpcData.sms_template;\n\t}\n    if (flybird.rpcData.local){\n\t    obj[\"action\"][\"params\"][\"local\"]  = flybird.rpcData.local;\n\t}\n\tif (flybird.rpcData.resend_url){\n\t    obj[\"action\"][\"params\"][\"resend_url\"]  = flybird.rpcData.resend_url;\n\t}\n    \n    //### 设置用户提交的参数\n    var submit_obj = {\"smsCode\": document.getElementById('pwd').value};\n    obj[\"param\"] = submit_obj;\n    \n\tant.asyncSubmit(obj, function(data) {\n        //### 出错了引擎会提示，成功后引擎会自动跳转。这里出错时将验证码标为红色.\n        document.getElementById('pwd').style.cssText=\"color:#FF0000;\";\n\t\tdocument.getElementById('submit').disabled = false;\n\t});\n\t\n\tdocument.getElementById('submit').disabled = true;\n}\n\n//### 退出\nfunction onBack(){\n    var dialogObj = {\n        title: '',\n        message: '确定要退出吗',\n        okButton: '确定',\n        cancelButton: '取消'\n    };\n    \n    ant.confirm(dialogObj, function (result) {\n        if (result.ok) {\n            ant.submit({\"action\":{\"name\":\"loc:exit\"}});\n        }\n    });\n}"}],"tag":"script"},{"href":"AlipaySDK.bundle/common.css","rel":"stylesheet","tag":"link","type":"text/css"},{"href":"com.alipay.android.app/common.css","rel":"stylesheet","tag":"link","type":"text/css"},{"tag":"style"}],"tag":"head"},{"children":[{"children":[{"children":[{"children":[{"css":"common_nav_left_img","id":"nav_back_img","tag":"img"},{"children":[{"tag":"text","text":"返回"}],"css":"common_nav_left_text","tag":"p"}],"css":"common_nav_left_box","id":"nav_back","onclick":"onBack()","tag":"div"},{"children":[{"children":[{"tag":"text","text":"身份验证"}],"css":"common_nav_center_text","tag":"label"}],"css":"common_nav_center_box","tag":"div"},{"css":"common_nav_right_box","tag":"div"}],"css":"common_nav_box","id":"ios_nav","tag":"div"},{"children":[{"children":[{"children":[{"css":"common_nav_left_img_android","id":"nav_back_img_android","tag":"img"}],"css":"common_nav_back_box_android","onclick":"onBack()","tag":"div"},{"css":"common_nav_line_android","tag":"div"},{"children":[{"tag":"text","text":"身份验证"}],"css":"common_nav_center_text common_p_reset","tag":"label"}],"css":"common_nav_title_android","id":"nav_back","tag":"div"},{"css":"common_nav_right_box","tag":"div"}],"css":"common_nav_box_android","id":"android_nav","tag":"div"}],"tag":"nav"},{"children":[{"css":"common_full_bottom_text","id":"main_title","tag":"label"}],"css":"common_padding_left_right common_full_title","id":"common_full_title","tag":"div"},{"children":[{"css":"common_1px_line","tag":"div"},{"children":[{"children":[{"children":[{"tag":"text","text":"校验码"}],"css":"common_cell_left_box_text","tag":"label"}],"css":"common_cell_left_box","tag":"div"},{"children":[{"autofocus":"true","css":"common_cell_input","id":"pwd","oninput":"onPwdInput()","placeholder":"短信校验码","tag":"input","type":"NumbersAndPunctuation"}],"css":"common_cell_center_box","style":"padding-right:3px;","tag":"div"},{"css":"common_cell_vert_line","tag":"div"},{"children":[{"children":[{"tag":"text","text":"重发校验码"}],"css":"common_cell_text_size common_cell_input common_theme_text_color common_button_no_bg","disabled":"disabled","id":"resend_btn","onclick":"submitReSend()","style":"width:100%;height:100%","tag":"button"}],"style":"width:103px; height:100%;","tag":"div"}],"css":"common_cell common_padding_left_right","style":"padding-right:0px;","tag":"div"},{"css":"common_1px_line","tag":"div"},{"css":"common_cell_footer_empty_box","tag":"div"},{"children":[{"children":[{"tag":"text","text":"下一步"}],"css":"common_button_main","disabled":"true","id":"submit","onclick":"submitInfo()","tag":"button"}],"css":"common_padding_left_right","tag":"div"}],"css":"common_full_main","id":"main_body","tag":"div"}],"css":"common_full_body","id":"body","onkeydown":"onBack();","onload":"init()","tag":"body"}],"tag":"html"},"format":"JSON","name":"cashier-safeprotect-sms","publishVersion":"150604","tag":"QUICKPAY","time":"0034","tplId":"QUICKPAY@cashier-safeprotect-sms","tplVersion":"5.0.0"}