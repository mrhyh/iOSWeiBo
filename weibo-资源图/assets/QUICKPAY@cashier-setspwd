{"data":{"children":[{"children":[{"content":"text/html; charset=UTF-8","http-equiv":"Content-Type","tag":"meta"},{"content":"width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=0, minimal-ui","name":"viewport","tag":"meta"},{"src":"cashier-setspwd.js","tag":"script"},{},{"src":"common.js","tag":"script"},{},{"src":"AlipaySDK.bundle/common.js","tag":"script"},{"children":[{"tag":"text","text":"var tipsSet=\"请设置6位数字支付密码，用于支付宝付款\";var tipsRepeat=\"请再次确认\";var actionSet=\"\";var actionRepeat=\"\";var protocols=[{text:\"支付宝服务协议\",url:\"https://mgw.alipay.com/agreement.htm\"},{text:\"保险条款\",url:\"https://ds.alipay.com/baoxian/zhxprotocol.htm\"}];var recommendNoPwd=false;var selectOpenNoPwd=false;var canGiveBaoxian=false;var isBaoxianOpen=false;var showServiceProtocol=true;var protocolCount=0;var protocolIndex=0;var checkbox=null;var checkLabel=null;function initSetting(){if(rpcData.setSpwdType==\"quser\"){actionSet=\"/cashier/setSpwd\";actionRepeat=\"/cashier/saveSpwd\"}else{if(rpcData.setSpwdType==\"complete\"){tipsSet=\"本次支付成功\\n请设置6位数字支付密码，保障资金安全\";actionSet=\"/complete/spwd\";actionRepeat=\"/complete/savespwd\";showServiceProtocol=false}}}function init(){initSetting();initCheckBox();if(isAndroid){getById(\"iosNav\").style.display=\"none\";getById(\"navBackImgAndroid\").src=path+\"back.png\"}else{if(!isFlybird){getById(\"android_nav\").style.display=\"none\"}getById(\"navBackPng\").src=path+\"arrow_left.png\"}getById(\"secondPage\").style.display=\"none\";getById(\"tips\").innerText=tipsSet;getById(\"spwd\").focus()}function onSpwdInput(){resetErrMsg();var a=getById(\"spwd\");if(a.value.length==6){onFirstInput()}}function handleResponse(a){recommendNoPwd=(a.recommendNoPwd==\"true\");selectOpenNoPwd=(a.selectOpenNoPwd==\"true\");canGiveBaoxian=(a.canGiveBaoxian==\"true\");isBaoxianOpen=(a.isBaoxianOpen==\"true\");checkbox.checked=selectOpenNoPwd;if(canGiveBaoxian){checkLabel.innerText=\"免费获赠账户安全险，最高保额100万！付款金额小于200元，无需输入支付密码。\"}else{checkLabel.innerText=\"付款金额小于200元，无需输入支付密码。\"}if(recommendNoPwd){getById(\"checkArea\").style.display=\"-webkit-box\"}else{getById(\"checkArea\").style.display=\"none\"}protocolCount=0;protocolIndex=0;if(showServiceProtocol){protocolCount++;protocolIndex=0}if(recommendNoPwd&&canGiveBaoxian){protocolCount++;protocolIndex=1}getById(\"agreeProtocol\").style.display=\"block\";if(protocolCount==1){getById(\"protocol\").innerText=protocols[protocolIndex][\"text\"];if(protocolIndex==1){getById(\"agree\").innerText=\"查看\"}}else{if(protocolCount==2){getById(\"protocol\").innerText=\"用户协议\"}else{getById(\"agreeProtocol\").style.display=\"none\"}}}function onFirstInput(){var c={action:{name:actionSet}};var b=getById(\"spwd\").encryptValue;if(!b){b=getById(\"spwd\").value}var a={spwd:b};a.encryptType=\"RSA\";c.param=a;ant.asyncSubmit(c,function(d){if(d.status==\"0001\"){handleResponse(d);getById(\"spwd\").style.display=\"none\";getById(\"tips\").innerText=tipsRepeat;getById(\"spwdRepeat\").value=\"\";getById(\"spwdRepeat\").style.display=\"block\";getById(\"secondPage\").style.display=\"block\";getById(\"firstPage\").style.display=\"none\";getById(\"nextBtn\").disabled=true;getById(\"spwdRepeat\").focus()}else{if(d.status==\"0000\"){getById(\"spwd\").disabled=false;getById(\"spwd\").value=\"\";if(d.errMsg){resetErrMsg(d.errMsg)}getById(\"spwd\").focus()}}})}function onSpwdRepeatInput(){resetErrMsg();var a=getById(\"spwdRepeat\");if(a.value.length==6){getById(\"nextBtn\").disabled=false}else{getById(\"nextBtn\").disabled=true}}function onSubmit(){var d={action:{name:actionRepeat}};var c=getById(\"spwdRepeat\");var b=c.encryptValue;if(!b){b=c.value}var a={spwd:b};a.encryptType=\"RSA\";if(checkbox){if(checkbox.checked){a.openNopwdSwitch=true}else{a.openNopwdSwitch=false}}a.openBaoxian=canGiveBaoxian;d.param=a;ant.asyncSubmit(d,function(e){if(e.status==\"0000\"){if(e.errMsg){resetErrMsg(e.errMsg)}againOnce()}})}function againOnce(){getById(\"spwd\").value=\"\";getById(\"spwd\").style.display=\"block\";getById(\"spwdRepeat\").style.display=\"none\";getById(\"secondPage\").style.display=\"none\";getById(\"firstPage\").style.display=\"block\";getById(\"tips\").innerText=tipsSet;getById(\"spwd\").focus()}function showProtocol(){if(protocolCount==1){ant.submit({action:{name:\"loc:openweb('\"+protocols[protocolIndex][\"url\"]+\"','\"+protocols[protocolIndex][\"text\"]+\"')\"}});return}var b=new Array();for(var a=0;a<protocols.length;a++){b.push(protocols[a][\"text\"])}ant.actionSheet({btns:b,cancelBtn:\"取消\"},function(c){ant.submit({action:{name:\"loc:openweb('\"+protocols[c.index][\"url\"]+\"','\"+protocols[c.index][\"text\"]+\"')\"}})})}function resetErrMsg(a){if(a==undefined){a=\"\"}if(a.length>0){getById(\"errMsg\").innerText=a;getById(\"errMsgBox\").style.display=\"block\"}else{getById(\"errMsg\").innerText=\"\";getById(\"errMsgBox\").style.display=\"none\"}}function initCheckBox(){if(isFlybird){checkbox=document.createElement(\"checkbox\");checkbox.className=\"common_checkbox\"}else{checkbox=document.createElement(\"input\");checkbox.type=\"checkbox\"}checkbox.checked=false;var a=getById(\"checkArea\");a.appendChild(checkbox);checkLabel=document.createElement(\"label\");checkLabel.className=\"common_cell_small_text_size\";checkLabel.style.cssText=\"padding-left:5px;\";var b=document.createElement(\"div\");b.style.cssText=\"-webkit-box-flex:1.0;\";b.appendChild(checkLabel);a.appendChild(b)}function onBack(){if(getById(\"spwd\").style.display==\"none\"){againOnce()}else{exitConfirm()}};"}],"tag":"script","type":"text/javascript"},{"href":"AlipaySDK.bundle/common.css","rel":"stylesheet","tag":"link","type":"text/css"},{"tag":"style"}],"tag":"head"},{"children":[{"children":[{"children":[{"children":[{"css":"common_nav_left_img","id":"navBackPng","tag":"img"},{"children":[{"tag":"text","text":"返回"}],"css":"common_nav_left_text","tag":"label"}],"css":"common_nav_left_box","id":"navBack","onclick":"onBack()","tag":"div"},{"children":[{"children":[{"tag":"text","text":"设置支付密码"}],"css":"common_nav_center_text","tag":"label"}],"css":"common_nav_center_box","tag":"div"},{"css":"common_nav_right_box","tag":"div"}],"css":"common_nav_box","id":"iosNav","tag":"div"},{"children":[{"children":[{"children":[{"css":"common_nav_left_img_android","id":"navBackImgAndroid","tag":"img"}],"css":"common_nav_back_box_android","onclick":"onBack()","tag":"div"},{"css":"common_nav_line_android","tag":"div"},{"children":[{"tag":"text","text":"设置支付密码"}],"css":"common_nav_center_text common_p_reset","tag":"label"}],"css":"common_nav_title_android","id":"navBack","tag":"div"},{"css":"common_nav_right_box","tag":"div"}],"css":"common_nav_box_android","id":"android_nav","tag":"div"}],"tag":"nav"},{"children":[{"children":[{"css":"common_full_bottom_text","id":"tips","tag":"label"}],"css":"common_full_title","style":"padding-top:2.5px;text-align:center;","tag":"div"},{"children":[{"children":[{"css":"common_spwd","id":"spwd","maxlength":"6","oninput":"onSpwdInput()","tag":"input","type":"payword"},{"css":"common_spwd","id":"spwdRepeat","maxlength":"6","oninput":"onSpwdRepeatInput()","tag":"input","type":"payword"}],"css":"common_spwd_box","id":"spwdBox","tag":"div"}],"css":"common_padding_top_bottom","tag":"div"},{"children":[{"children":[{"tag":"text","text":"两次密码输入不一致，请重新输入"}],"id":"errMsg","style":"color:#F4333C","tag":"label"}],"id":"errMsgBox","style":"text-align:center;padding-top:2.5px;padding-bottom:15px;display:none;","tag":"div"},{"children":[{"tag":"text","text":"密码不能为连续、重复数字或者你的生日"}],"css":"common_cell_small_text_size common_cell_small_text_light_color","id":"firstPage","style":"margin-left:5px;","tag":"label"},{"children":[{"id":"checkArea","style":"-webkit-box-align:start;padding-bottom:15px;","tag":"div"},{"children":[{"children":[{"tag":"text","text":"同意"}],"css":"common_full_bottom_text","id":"agree","style":"padding-right:5px;","tag":"label"},{"children":[{"tag":"text","text":"支付宝服务协议"}],"css":"common_full_bottom_text common_theme_text_color","id":"protocol","onclick":"showProtocol()","tag":"label"}],"id":"agreeProtocol","style":"padding-top:2.5px;","tag":"div"},{"children":[{"tag":"text","text":"下一步"}],"css":"common_button_main","disabled":"disabled","id":"nextBtn","onclick":"onSubmit()","style":"margin-top:20px;","tag":"button"}],"id":"secondPage","tag":"div"}],"css":"common_full_main common_padding_left_right","id":"mainBody","tag":"div"}],"css":"common_full_body","id":"body","onkeydown":"onBack();","onload":"init()","tag":"body"}],"tag":"html"},"format":"JSON","name":"cashier-setspwd","publishVersion":"150806","tag":"QUICKPAY","time":"0007","tplId":"QUICKPAY@cashier-setspwd","tplVersion":"5.0.1"}